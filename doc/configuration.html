<!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-  2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Apache Shiro is a powerful and easy-to-use Java security framework that performs authentication, authorization, cryptography, and session management.">

    <title>Apache Shiro | Java Security Framework</title>

    <link rel="icon" type="image/vnd.microsoft.icon" href="assets/images/favicon.ico">

    <link rel="stylesheet" type="text/css" href="assets/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="assets/css/confluence.css" media="screen">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">

   
</head>

<body>
    <div id="top-bar"></div>

    <div class="wrapper">

        <div id="header">
            <a href="index.html"><div id="logo"></div></a>
            <ul class="navigation">
                <li><a href="get-started.html">Get Started</a></li>
                <li><a href="documentation.html">Docs</a></li>
                <li><a href="web-features.html">Web Apps</a></li>
                <li><a href="integration.html">Integrations</a></li>
                <li><a href="features.html">Features</a></li>
                <li><a href="community.html">Community</a></li>
            </ul>
        </div>

        <div id="content">

            <h1><a name="Configuration-ApacheShiroConfiguration"></a>Apache Shiro的配置</h1>

<div class="toc">
<ul><li><a href="#Configuration-ProgrammaticConfiguration">Programmatic Configuration</a></li><ul><li><a href="#Configuration-SecurityManagerObjectGraph">SecurityManager Object Graph</a></li></ul><li><a href="#Configuration-INIConfiguration">INI Configuration</a></li><ul><li><a href="#Configuration-CreatingaSecurityManagerfromINI">Creating a SecurityManager from INI</a></li><ul><li><a href="#Configuration-SecurityManagerfromanINIresource">SecurityManager from an INI resource</a></li><li><a href="#Configuration-SecurityManagerfromanINIinstance">SecurityManager from an INI instance</a></li></ul><li><a href="#Configuration-INISections">INI Sections</a></li><ul><li><a href="#Configuration-%5Cmain%5C">[main]</a></li><ul><li><a href="#Configuration-Defininganobject">Defining an object</a></li><li><a href="#Configuration-Settingobjectproperties">Setting object properties</a></li><ul><li><a href="#Configuration-PrimitiveValues">Primitive Values</a></li><li><a href="#Configuration-ReferenceValues">Reference Values</a></li><li><a href="#Configuration-NestedProperties">Nested Properties</a></li><li><a href="#Configuration-ByteArrayValues">Byte Array Values</a></li><li><a href="#Configuration-CollectionProperties">Collection Properties</a></li></ul><li><a href="#Configuration-Considerations">Considerations</a></li><ul><li><a href="#Configuration-OrderMatters">Order Matters</a></li><li><a href="#Configuration-OverridingInstances">Overriding Instances</a></li><li><a href="#Configuration-DefaultSecurityManager">Default SecurityManager</a></li></ul></ul><li><a href="#Configuration-%5Cusers%5C">[users]</a></li><ul><li><a href="#Configuration-LineFormat">Line Format</a></li><li><a href="#Configuration-EncryptingPasswords">Encrypting Passwords</a></li></ul><li><a href="#Configuration-%5Croles%5C">[roles]</a></li><ul><li><a href="#Configuration-LineFormat">Line Format</a></li></ul><li><a href="#Configuration-%5Curls%5C">[urls]</a></li></ul></ul><li><a href="#Configuration-Lendahandwithdocumentation">Lend a hand with documentation</a></li></ul></div>

<p>Shiro可以在简单的命令行程序以及企业集群应用中使用。因为可应用环境的多样性，Shiro支持多种配置方式。本节仅介绍Shiro核心模块支持的配置方法。</p>

<div class="panelMacro"><table class="tipMacro"><colgroup span="1"><col span="1" width="24"><col span="1"></colgroup><tr><td colspan="1" rowspan="1" valign="top"><img align="middle" src="https://cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" alt="" border="0"></td><td colspan="1" rowspan="1"><b>多种配置选择</b><br clear="none">Shiro中的<tt>SecurityManager</tt> 实现类及其所支持的组件都是JavaBeans兼容的，因此可以使用多种方式配置，比如Java, XML（Spring, JBoss, Guice等等）,<a class="external-link" href="http://www.yaml.org/default.htm" rel="nofollow">YAML</a>, JSON, Groovy Builder markup以及其他。</td></tr></table></div>

<h2><a name="Configuration-ProgrammaticConfiguration"></a>编程配置</h2>

<p>创建SecurityManager最最简单的方式就是在代码里new一个<tt>org.apache.shiro.mgt.DefaultSecurityManager</tt>对象，如下：</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
Realm realm = <span class="code-comment">// 实例化或获得一个Realm的实例，稍后讨论Realm。
</span>
<span class="code-object">SecurityManager</span> securityManager = <span class="code-keyword">new</span> DefaultSecurityManager(realm);

<span class="code-comment">// 使 <span class="code-object">SecurityManager</span> 可在整个应用里使用
</span>SecurityUtils.setSecurityManager(securityManager);
</pre>
</div></div>

<p>只用了三行代码就配置好一个功能完备适用许多应用的Shiro环境，so easy!!</p>

<h3><a name="Configuration-SecurityManagerObjectGraph"></a>SecurityManager 对象视图</h3>

<p>如之前在<a href="architecture.html" title="Architecture">架构</a>一章中所说, Shiro中所有<tt>SecurityManager</tt> 的实现本质上是其内部安全组件的一个模块化的对象图。因为兼容JavaBean，所以可通过调用这些内部组件的<tt>getter</tt>和 <tt>setter</tt>方法来配置<tt>SecurityManager</tt>。</p>

<p>比如说，你想定制shiro的<a href="session-management.html" title="Session Management">会话管理</a>功能，可以通过给<tt>SecurityManager</tt>配置一个自定义的<tt>SessionDAO</tt>。而配置<tt>SessionDAO</tt>只需直接调用SessionManager的<tt>setSessionDAO</tt>方法即可：</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
...

DefaultSecurityManager securityManager = <span class="code-keyword">new</span> DefaultSecurityManager(realm);

SessionDAO sessionDAO = <span class="code-keyword">new</span> CustomSessionDAO();

((DefaultSessionManager)securityManager.getSessionManager()).setSessionDAO(sessionDAO);
...
</pre>
</div></div>

<p>你可以使用类似的方法配置<tt>SecurityManager</tt>中的其他组件。</p>

<p>不过尽管编程化的配置方式很方便，但在实际的应用中会有些问题：</p>

<ul><li>你需要知道并实例化某些组件的直接实现类，但其实不用关心具体实现类和它们的位置会更好。
<br clear="none" class="atl-forced-newline"></li><li>因为Java是类型安全的，对某些通过<tt>get*</tt>方法获取的对象需要强制转换。但是强制转换的代码太丑，太罗嗦，与具体的实现类耦合太紧。
<br clear="none" class="atl-forced-newline"></li><li>调用<tt>SecurityUtils.setSecurityManager</tt>方法会创建<tt>SecurityManager</tt>的一个静态单例对象，这么做虽然在某些应用中行得通，但在同一个JVM中运行多个Shiro程序的情况下会出问题。使用单例对象非常好，但不应该变成静态的。
<br clear="none" class="atl-forced-newline"></li><li>每次变更配置都需要重新编译。</li></ul>


<p>However, even with these caveats, the direct programmatic manipulation approach could still be valuable in memory-constrained environments, like smart-phone applications.  If your application does not run in a memory-constrained environment, you'll find text-based configuration to be easier to use and read.</p>

<h2><a name="Configuration-INIConfiguration"></a>INI Configuration</h2>

<p>Most applications instead benefit from text-based configuration that could be modified independently of source code and even make things easier to understand for those not intimately familiar with Shiro's APIs.</p>

<p>To ensure a common-denominator text-based configuration mechanism that can work in all environments with minimal 3rd party dependencies, Shiro supports the <a class="external-link" href="../en.wikipedia.org/wiki/INI_file" rel="nofollow">INI format</a> to build the <tt>SecurityManager</tt> object graph and its supporting components.  INI is easy to read, easy to configure, and is simple to set-up and suits most applications well.</p>

<h3><a name="Configuration-CreatingaSecurityManagerfromINI"></a>Creating a SecurityManager from INI</h3>

<p>Here are two examples of how to build a SecurityManager based on INI configuration.</p>

<h4><a name="Configuration-SecurityManagerfromanINIresource"></a>SecurityManager from an INI resource</h4>

<p>We can create the SecurityManager instance from an INI resource path.  Resources can be acquired from the file system, classpath, or URLs when prefixed with <tt>file:</tt>, <tt>classpath:</tt>, or <tt>url:</tt> respectively.  This example uses a <tt>Factory</tt> to ingest a <tt>shiro.ini</tt> file from the root of the classpath and return the <tt>SecurityManager</tt> instance:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
<span class="code-keyword">import</span> org.apache.shiro.SecurityUtils;
<span class="code-keyword">import</span> org.apache.shiro.util.Factory;
<span class="code-keyword">import</span> org.apache.shiro.mgt.<span class="code-object">SecurityManager</span>;
<span class="code-keyword">import</span> org.apache.shiro.config.IniSecurityManagerFactory;

...

Factory&lt;<span class="code-object">SecurityManager</span>&gt; factory = <span class="code-keyword">new</span> IniSecurityManagerFactory(<span class="code-quote">"classpath:shiro.ini"</span>);
<span class="code-object">SecurityManager</span> securityManager = factory.getInstance();
SecurityUtils.setSecurityManager(securityManager);
</pre>
</div></div>

<h4><a name="Configuration-SecurityManagerfromanINIinstance"></a>SecurityManager from an INI instance</h4>

<p>The INI configuration can be constructed programmatically as well if desired via the <tt><a class="external-link" href="static/current/apidocs/org/apache/shiro/config/Ini.html">org.apache.shiro.config.Ini</a></tt> class.  The Ini class functions similarly to the JDK <tt><a class="external-link" href="../download.oracle.com/javase/6/docs/api/java/util/Properties.html" rel="nofollow">java.util.Properties</a></tt> class, but additionally supports segmentation by section name.  </p>

<p>For example:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
<span class="code-keyword">import</span> org.apache.shiro.SecurityUtils;
<span class="code-keyword">import</span> org.apache.shiro.util.Factory;
<span class="code-keyword">import</span> org.apache.shiro.mgt.<span class="code-object">SecurityManager</span>;
<span class="code-keyword">import</span> org.apache.shiro.config.Ini;
<span class="code-keyword">import</span> org.apache.shiro.config.IniSecurityManagerFactory;

...

Ini ini = <span class="code-keyword">new</span> Ini();
<span class="code-comment">//populate the Ini instance as necessary
</span>...
Factory&lt;<span class="code-object">SecurityManager</span>&gt; factory = <span class="code-keyword">new</span> IniSecurityManagerFactory(ini);
<span class="code-object">SecurityManager</span> securityManager = factory.getInstance();
SecurityUtils.setSecurityManager(securityManager);
</pre>
</div></div>

<p>Now that we know how to construct a <tt>SecurityManager</tt> from INI configuration, let's take a look at exactly how to define a Shiro INI configuration.</p>

<h3><a name="Configuration-INISections"></a>INI Sections</h3>

<p>INI is basically a text configuration consisting of key/value pairs organized by uniquely-named sections.  Keys are unique per section only, not over the entire configuration (unlike the JDK  <a class="external-link" href="../java.sun.com/javase/6/docs/api/java/util/Properties.html" rel="nofollow">Properties</a>).  Each section may be viewed like a single <tt>Properties</tt> definition however.</p>

<p>Commented lines can start with either with an Octothorpe (# - aka the 'hash', 'pound' or 'number' sign) or a Semi-colon (';')</p>

<p>Here is an example of the sections understood by Shiro:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
# =======================
# Shiro INI configuration
# =======================

[main]
# Objects and their properties are defined here, 
# Such as the securityManager, Realms and anything
# <span class="code-keyword">else</span> needed to build the <span class="code-object">SecurityManager</span>

[users]
# The 'users' section is <span class="code-keyword">for</span> simple deployments
# when you only need a small number of statically-defined 
# set of User accounts.

[roles]
# The 'roles' section is <span class="code-keyword">for</span> simple deployments
# when you only need a small number of statically-defined
# roles.

[urls]
# The 'urls' section is used <span class="code-keyword">for</span> url-based security
# in web applications.  We'll discuss <span class="code-keyword">this</span> section in the
# Web documentation
</pre>
</div></div>

<h4><a name="Configuration-%5Cmain%5C"></a>[main]</h4>

<p>The <tt><b>[main]</b></tt> section is where you configure the application's <tt>SecurityManager</tt> instance and any of its dependencies, such as <a href="realm.html" title="Realm">Realm</a>s.</p>

<p>Configuring object instances like the SecurityManager or any of its dependencies sounds like a difficult thing to do with INI, where we can only use name/value pairs.  But through a little bit of convention and understanding of object graphs, you'll find that you can do quite a lot.  Shiro uses these assumptions to enable a simple yet fairly concise configuration mechanism.</p>

<p>We often like to refer to this approach as "poor man's" Dependency Injection, and although not as powerful as full-blown Spring/Guice/JBoss XML files, you'll find it gets quite a lot done without much complexity.  Of course those other configuration mechanism are available as well, but they're not required to use Shiro.</p>

<p>Just to whet your appetite, here is an example of a valid <tt>[main]</tt> configuration.  We'll cover it in detail below, but you might find that you understand quite a bit of what is going on already by intuition alone:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[main]
sha256Matcher = org.apache.shiro.authc.credential.Sha256CredentialsMatcher

myRealm = com.company.security.shiro.DatabaseRealm
myRealm.connectionTimeout = 30000
myRealm.username = jsmith
myRealm.password = secret
myRealm.credentialsMatcher = $sha256Matcher

securityManager.sessionManager.globalSessionTimeout = 1800000
</pre>
</div></div>

<h5><a name="Configuration-Defininganobject"></a>Defining an object</h5>

<p>Consider the following <tt>[main]</tt> section snippet:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[main]
myRealm = com.company.shiro.realm.MyRealm
...
</pre>
</div></div>

<p>This line instantiates a new object instance of type <tt>com.company.shiro.realm.MyRealm</tt> and makes that object available under the <b>myRealm</b> name for further reference and configuration.</p>

<p>If the object instantiated implements the <tt>org.apache.shiro.util.Nameable</tt> interface, then the the <tt>Nameable.setName</tt> method will be invoked on the object with the name value (<b>myRealm</b> in this example).</p>

<h5><a name="Configuration-Settingobjectproperties"></a>Setting object properties</h5>

<h6><a name="Configuration-PrimitiveValues"></a>Primitive Values</h6>

<p>Simple primitive properties can be assigned just by using the equals sign:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
...
myRealm.connectionTimeout = 30000
myRealm.username = jsmith
...
</pre>
</div></div>

<p>these lines of configuration translate into method calls:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
...
myRealm.setConnectionTimeout(30000);
myRealm.setUsername(<span class="code-quote">"jsmith"</span>);
...
</pre>
</div></div>

<p>How is this possible?  It assumes that all objects are <a class="external-link" href="../en.wikipedia.org/wiki/JavaBean" rel="nofollow">Java Beans</a>-compatible <a class="external-link" href="../en.wikipedia.org/wiki/Plain_Old_Java_Object" rel="nofollow">POJO</a>s.</p>

<p>Under the covers, Shiro by default uses Apache Commons <a class="external-link" href="../commons.apache.org/beanutils/default.htm">BeanUtils</a> to do all the heavy lifting when setting these properties.  So although INI values are text, BeanUtils knows how to convert the string values to the proper primitive types and then invoke the corresponding JavaBeans setter method.</p>

<h6><a name="Configuration-ReferenceValues"></a>Reference Values</h6>

<p>What if the value you need to set is not a primitive, but another object?  Well, you can use a dollar sign ($) to reference a previously-defined instance.  For example:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
...
sha256Matcher = org.apache.shiro.authc.credential.Sha256CredentialsMatcher
...
myRealm.credentialsMatcher = $sha256Matcher
...
</pre>
</div></div>

<p>This simply locates the object defined by the name <b>sha256Matcher</b> and then uses BeanUtils to set that object on the <b>myRealm</b> instance (by calling the <tt>myRealm.setCredentialsMatcher(sha256Matcher)</tt> method).</p>

<h6><a name="Configuration-NestedProperties"></a>Nested Properties</h6>

<p>Using dotted notation on the left side of the INI line's equals sign, you can traverse an object graph to get to the final object/property that you want set.  For example, this config line:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
...
securityManager.sessionManager.globalSessionTimeout = 1800000
...
</pre>
</div></div>

<p>Translates (by BeanUtils) into the following logic:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
securityManager.getSessionManager().setGlobalSessionTimeout(1800000);
</pre>
</div></div>

<p>The graph traversal can be as deep as necessary: <tt>object.property1.property2....propertyN.value = blah</tt></p>

<div class="panelMacro"><table class="tipMacro"><colgroup span="1"><col span="1" width="24"><col span="1"></colgroup><tr><td colspan="1" rowspan="1" valign="top"><img align="middle" src="../https@cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" alt="" border="0"></td><td colspan="1" rowspan="1"><b>BeanUtils Property Support</b><br clear="none">Any property assignment operation supported by the BeanUtils.<a class="external-link" href="../commons.apache.org/beanutils/v1.8.2/apidocs/org/apache/commons/beanutils/BeanUtils.html#setProperty%28java.lang.Object,%20java.lang.String,%20java.lang.Object%29">setProperty</a> method will work in Shiro's [main] section, including set/list/map element assignments.  See the <a class="external-link" href="../commons.apache.org/beanutils/default.htm">Apache Commons BeanUtils Website</a> and documentation for more information.</td></tr></table></div>

<h6><a name="Configuration-ByteArrayValues"></a>Byte Array Values</h6>

<p>Because raw byte arrays can't be specified natively in a text format, we must use a text encoding of the byte array.  The values can be specified either as a Base64 encoded string (the default) or as a Hex encoded string.  The default is Base64 because Base64 encoding requires less actual text to represent values - it has a larger encoding alphabet, meaning your tokens are shorter (a bit nicer for text config).</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
# The 'cipherKey' attribute is a <span class="code-object">byte</span> array.    By <span class="code-keyword">default</span>, text values 
# <span class="code-keyword">for</span> all <span class="code-object">byte</span> array properties are expected to be Base64 encoded:

securityManager.rememberMeManager.cipherKey = kPH+bIxk5D2deZiIxcaaaA==
...
</pre>
</div></div>

<p>However, if you prefer to use Hex encoding instead, you must prefix the String token with <tt>0x</tt> ('zero' 'x'):</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
securityManager.rememberMeManager.cipherKey = 0x3707344A4093822299F31D008
</pre>
</div></div>

<h6><a name="Configuration-CollectionProperties"></a>Collection Properties</h6>

<p>Lists, Sets and Maps can be set like any other property - either directly or as a nested property.  For sets and lists, just specify a comma-delimited set of values or object references.</p>

<p>For example, some SessionListeners:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
sessionListener1 = com.company.my.SessionListenerImplementation
...
sessionListener2 = com.company.my.other.SessionListenerImplementation
...
securityManager.sessionManager.sessionListeners = $sessionListener1, $sessionListener2
</pre>
</div></div>

<p>For Maps, you specify a comma-delimited list of key-value pairs, where each key-value pair is delimited by a colon ':'</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
object1 = com.company.some.<span class="code-object">Class</span>
object2 = com.company.another.<span class="code-object">Class</span>
...
anObject = some.class.with.a.Map.property

anObject.mapProperty = key1:$object1, key2:$object2
</pre>
</div></div>

<p>In the above example, the object referenced by <tt>$object1</tt> will be in the map under the String key <tt>key1</tt>, i.e. <tt>map.get("key1")</tt> returns <tt>object1</tt>.  You can also use other objects as the keys:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
anObject.map = $objectKey1:$objectValue1, $objectKey2:$objectValue2
...
</pre>
</div></div>

<h5><a name="Configuration-Considerations"></a>Considerations</h5>

<h6><a name="Configuration-OrderMatters"></a>Order Matters</h6>

<p>The INI format and conventions above are very convenient and easy to understand, but it is not as powerful as other text/XML-based configuration mechanisms.  The most important thing to understand when using the above mechanism is that <b>Order Matters!</b></p>

<div class="panelMacro"><table class="noteMacro"><colgroup span="1"><col span="1" width="24"><col span="1"></colgroup><tr><td colspan="1" rowspan="1" valign="top"><img align="middle" src="../https@cwiki.apache.org/confluence/images/icons/emoticons/warning.gif" width="16" height="16" alt="" border="0"></td><td colspan="1" rowspan="1"><b>Be Careful</b><br clear="none">Each object instantiation and each value assignment is executed <em>in the order they occur in the [main] section</em>.  These lines ultimately translate to a JavaBeans getter/setter method invocation, and so those methods are invoked in the same order!

<p>Keep this in mind when writing your configuration.</p></td></tr></table></div>

<h6><a name="Configuration-OverridingInstances"></a>Overriding Instances</h6>

<p>Any object can be overridden by a new instance defined later in the configuration.  So for example, the 2nd <tt>myRealm</tt> definition would overwrite the first:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
...
myRealm = com.company.security.MyRealm
...
myRealm = com.company.security.DatabaseRealm
...
</pre>
</div></div>

<p>This would result in <tt>myRealm</tt> being a <tt>com.company.security.DatabaseRealm</tt> instance and the previous instance will never be used (and garbage collected).</p>

<h6><a name="Configuration-DefaultSecurityManager"></a>Default SecurityManager</h6>

<p>You may have noticed in the complete example above that the SecurityManager instance's class isn't defined, and we jumped right in to just setting a nested property:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
myRealm = ...

securityManager.sessionManager.globalSessionTimeout = 1800000
...
</pre>
</div></div>

<p>This is because the <tt>securityManager</tt> instance is a special one - it is already instantiated for you and ready to go so you don't need to know the specific <tt>SecurityManager</tt> implementation class to instantiate.</p>

<p>Of course, if you actually <em>want</em> to specify your own implementation, you can, just define your implementation as specified in the "Overriding Instances" section above:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
...
securityManager = com.company.security.shiro.MyCustomSecurityManager
...
</pre>
</div></div>

<p>Of course, this is rarely needed - Shiro's SecurityManager implementations are very customizable and can typically be configured with anything necessary.  You might want to ask yourself (or the user list) if you really need to do this.<br clear="none">
<a href="#Configuration-users">users</a></p>
<h4><a name="Configuration-%5Cusers%5C"></a>[users]</h4>

<p>The <tt><b>[users]</b></tt> section allows you to define a static set of user accounts.  This is mostly useful in environments with a very small number of user accounts or where user accounts don't need to be created dynamically at runtime.  Here's an example:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[users]
admin = secret
lonestarr = vespa, goodguy, schwartz
darkhelmet = ludicrousspeed, badguy, schwartz
</pre>
</div></div>

<div class="panelMacro"><table class="infoMacro"><colgroup span="1"><col span="1" width="24"><col span="1"></colgroup><tr><td colspan="1" rowspan="1" valign="top"><img align="middle" src="../https@cwiki.apache.org/confluence/images/icons/emoticons/information.gif" width="16" height="16" alt="" border="0"></td><td colspan="1" rowspan="1"><b>Automatic IniRealm</b><br clear="none">Just defining non-empty [users] or [roles] sections will automatically trigger the creation of an <tt><a class="external-link" href="static/current/apidocs/org/apache/shiro/realm/text/IniRealm.html">org.apache.shiro.realm.text.IniRealm</a></tt> instance and make it available in the [main] section under the name <tt><b>iniRealm</b></tt>.  You can configure it like any other object as described above.</td></tr></table></div>

<h5><a name="Configuration-LineFormat"></a>Line Format</h5>

<p>Each line in the [users] section must conform to the following format:</p>

<p><tt>username</tt> = <tt>password</tt>, <em>roleName1</em>, <em>roleName2</em>, ..., <em>roleNameN</em></p>

<ul><li>The value on the left of the equals sign is the username</li><li>The first value on the right of the equals sign is the user's password.  A password is required.</li><li>Any comma-delimited values after the password are the names of roles assigned to that user.  Role names are optional.</li></ul>


<h5><a name="Configuration-EncryptingPasswords"></a>Encrypting Passwords</h5>

<p>If you don't want the [users] section passwords to be in plain-text, you can encrypt them using your favorite hash algorithm (MD5, Sha1, Sha256, etc) however you like and use the resulting string as the password value.  By default, the password string is expected to be Hex encoded, but can be configured to be Base64 encoded instead (see below).</p>

<div class="panelMacro"><table class="tipMacro"><colgroup span="1"><col span="1" width="24"><col span="1"></colgroup><tr><td colspan="1" rowspan="1" valign="top"><img align="middle" src="../https@cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" alt="" border="0"></td><td colspan="1" rowspan="1"><b>Easy Secure Passwords</b><br clear="none">To save time and use best-practices, you might want to use Shiro's <a href="command-line-hasher.html" title="Command Line Hasher">Command Line Hasher</a>, which will hash passwords as well as any other type of resource.  It is especially convenient for encrypting INI <tt>[users]</tt> passwords.</td></tr></table></div>

<p>Once you've specified the hashed text password values, you have to tell Shiro that these are encrypted.  You do that by configuring the implicitly created <tt>iniRealm</tt> in the [main] section to use an appropriate <tt>CredentialsMatcher</tt> implementation corresponding to the hash algorithm you've specified:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[main]
...
sha256Matcher = org.apache.shiro.authc.credential.Sha256CredentialsMatcher
...
iniRealm.credentialsMatcher = $sha256Matcher
...

[users]
# user1 = sha256-hashed-hex-encoded password, role1, role2, ...
user1 = 2bb80d537b1da3e38bd30361aa855686bde0eacd7162fef6a25fe97bf527a25b, role1, role2, ... 
</pre>
</div></div>

<p>You can configure any properties on the <tt>CredentialsMatcher</tt> like any other object to reflect your hashing strategy, for example, to specify if salting is used or how many hash iterations to execute.  See the <tt><a class="external-link" href="static/current/apidocs/org/apache/shiro/authc/credential/HashedCredentialsMatcher.html">org.apache.shiro.authc.credential.HashedCredentialsMatcher</a></tt> JavaDoc to better understand hashing strategies and if they might be useful to you.  </p>

<p>For example, if your users' password strings were Base64 encoded instead of the default Hex, you could specify:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[main]
...
# <span class="code-keyword">true</span> = hex, <span class="code-keyword">false</span> = base64:
sha256Matcher.storedCredentialsHexEncoded = <span class="code-keyword">false</span>
</pre>
</div></div>

<h4><a name="Configuration-%5Croles%5C"></a>[roles]</h4>

<p>The <tt><b>[roles]</b></tt> section allows you to associate <a href="permissions.html" title="Permissions">Permissions</a> with the roles defined in the [users] section.  Again, this is useful in environments with a small number of roles or where roles don't need to be created dynamically at runtime.  Here's an example:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[roles]
# 'admin' role has all permissions, indicated by the wildcard '*'
admin = *
# The 'schwartz' role can <span class="code-keyword">do</span> anything (*) with any lightsaber:
schwartz = lightsaber:*
# The 'goodguy' role is allowed to 'drive' (action) the winnebago (type) with
# license plate 'eagle5' (instance specific id)
goodguy = winnebago:drive:eagle5
</pre>
</div></div>

<h5><a name="Configuration-LineFormat"></a>Line Format</h5>

<p>Each line in the [roles] section must must define a role-to-permission(s) key/value mapping with in the following format:</p>

<p><tt>rolename</tt> = <em>permissionDefinition1</em>, <em>permissionDefinition2</em>, ..., <em>permissionDefinitionN</em></p>

<p>where <em>permissionDefinition</em> is an arbitrary String, but most people will want to use strings that conform<br clear="none">
to the <tt><a class="external-link" href="static/current/apidocs/org/apache/shiro/authz/permission/WildcardPermission.html">org.apache.shiro.authz.permission.WildcardPermission</a></tt> format for ease of use and flexibility.  See the <a href="permissions.html" title="Permissions">Permissions</a> documentation for more information on Permissions and how you can benefit from them. </p>

<div class="panelMacro"><table class="infoMacro"><colgroup span="1"><col span="1" width="24"><col span="1"></colgroup><tr><td colspan="1" rowspan="1" valign="top"><img align="middle" src="../https@cwiki.apache.org/confluence/images/icons/emoticons/information.gif" width="16" height="16" alt="" border="0"></td><td colspan="1" rowspan="1"><b>Internal commas</b><br clear="none">Note that if an individual <em>permissionDefinition</em> needs to be internally comma-delimited (e.g. <tt>printer:5thFloor:print,info</tt>), you will need to surround that definition with double quotes (") to avoid parsing errors:<br clear="none">
<tt>"printer:5thFloor:print,info"</tt></td></tr></table></div>

<div class="panelMacro"><table class="tipMacro"><colgroup span="1"><col span="1" width="24"><col span="1"></colgroup><tr><td colspan="1" rowspan="1" valign="top"><img align="middle" src="../https@cwiki.apache.org/confluence/images/icons/emoticons/check.gif" width="16" height="16" alt="" border="0"></td><td colspan="1" rowspan="1"><b>Roles without Permissions</b><br clear="none">If you have roles that don't require permission associations, you don't need to list them in the [roles] section if you don't want to.  Just defining the role names in the [users] section is enough to create the role if it does not exist yet.</td></tr></table></div>

<h4><a name="Configuration-%5Curls%5C"></a>[urls]</h4>

<p>This section and its options is described in the <a href="web.html" title="Web">Web</a> chapter.</p>

<h2><a name="Configuration-Lendahandwithdocumentation"></a>Lend a hand with documentation </h2>

<p>While we hope this documentation helps you with the work you're doing with Apache Shiro, the community is improving and expanding the documentation all the time.  If you'd like to help the Shiro project, please consider corrected, expanding, or adding documentation where you see a need. Every little bit of help you provide expands the community and in turn improves Shiro. </p>

<p>The easiest way to contribute your documentation is to send it to the <a class="external-link" href="../shiro-user.582556.n2.nabble.com/default.htm" rel="nofollow">User Forum</a> or the <a href="mailing-lists.html" title="Mailing Lists">User Mailing List</a>.</p>

        </div>

    </div><!--END WRAPPER-->

    <div id="footer">

        <div class="wrapper">

            <a href="../www.apache.org/foundation/contributing.html">Donate to the ASF</a> |
            <a href="../www.apache.org/licenses/LICENSE-2.0.html">License</a>
            <p>Copyright &copy; 2008-2014 The Apache Software Foundation</p>
            <div class="footer-shield"></div>

        </div> <!--END FOOTER WRAPPER-->

    </div> <!--END FOOTER-->

</body>
</html>
